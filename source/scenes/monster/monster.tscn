[gd_scene format=3 uid="uid://04m2i41b26xa"]

[ext_resource type="Script" uid="uid://c6yvnpxqt6x2u" path="res://scripts/monster/monster.gd" id="1_0ix62"]
[ext_resource type="Script" uid="uid://dlyn7myxb1v18" path="res://scripts/statemachine/statemachine.gd" id="1_jlss8"]
[ext_resource type="Script" uid="uid://buh1dyxd4gil8" path="res://scripts/monster/wander.gd" id="2_gdl1p"]
[ext_resource type="AudioStream" uid="uid://7m2mctf82f43" path="res://assets/sounds/monster/thud_3.mp3" id="2_gp4s5"]
[ext_resource type="Script" uid="uid://gd3kygbrdkps" path="res://scripts/monster/search.gd" id="3_0xprk"]
[ext_resource type="AudioStream" uid="uid://ck0s5sftvqvug" path="res://assets/sounds/monster/thud_1.mp3" id="3_gdl1p"]
[ext_resource type="AudioStream" uid="uid://cme26q6qadno" path="res://assets/sounds/monster/thud_2.mp3" id="4_v8ewj"]
[ext_resource type="Script" uid="uid://u07fggjsf3m3" path="res://scripts/monster/attack.gd" id="5_v8i5r"]
[ext_resource type="AudioStream" uid="uid://cyrd1qxasq04b" path="res://assets/sounds/monster/purr_1.mp3" id="6_fttm7"]
[ext_resource type="AudioStream" uid="uid://s1lcukk3380k" path="res://assets/sounds/monster/purr_2.mp3" id="7_akk5r"]
[ext_resource type="AudioStream" uid="uid://b6hv8h12hswr" path="res://assets/sounds/monster/purr_3.mp3" id="8_x2c6u"]
[ext_resource type="AudioStream" uid="uid://dh2onnnkei140" path="res://assets/sounds/monster/purr_4.mp3" id="9_ei7v0"]
[ext_resource type="AudioStream" uid="uid://ddh6fsuveww0" path="res://assets/sounds/monster/groan_1.mp3" id="21_6h0bv"]
[ext_resource type="AudioStream" uid="uid://cbvu03qhqhkhx" path="res://assets/sounds/monster/groan_2.mp3" id="22_0xprk"]
[ext_resource type="AudioStream" uid="uid://c3iss0ih36qw6" path="res://assets/sounds/monster/groan_3.mp3" id="23_0ix62"]
[ext_resource type="AudioStream" uid="uid://baxhgylquy6wk" path="res://assets/sounds/monster/groan_4.mp3" id="24_8luhx"]
[ext_resource type="AudioStream" uid="uid://bco4u4ji4pxsh" path="res://assets/sounds/monster/groan_5.mp3" id="25_xt71w"]
[ext_resource type="AudioStream" uid="uid://cgbn16af6nhnq" path="res://assets/sounds/monster/groan_6.mp3" id="26_ok33r"]
[ext_resource type="AudioStream" uid="uid://bgvgjjnfaesjj" path="res://assets/sounds/monster/groan_7.mp3" id="27_hejqc"]
[ext_resource type="AudioStream" uid="uid://cne2ieyn5vgjw" path="res://assets/sounds/monster/groan_8.mp3" id="30_8luhx"]
[ext_resource type="AudioStream" uid="uid://dxnakwin4gu5e" path="res://assets/sounds/monster/screech_1.mp3" id="32_nnbp4"]
[ext_resource type="AudioStream" uid="uid://cm8otp4qgl2kv" path="res://assets/sounds/monster/screech_2.mp3" id="33_4suij"]
[ext_resource type="AudioStream" uid="uid://gdtsec8s0kmq" path="res://assets/sounds/monster/screech_3.mp3" id="34_ysgge"]
[ext_resource type="PackedScene" uid="uid://jbyy44t3pgqv" path="res://scenes/monster/monster_visuals.tscn" id="37_4suij"]

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_yce20"]
random_pitch = 1.0594631
random_volume_offset_db = 1.0
streams_count = 3
stream_0/stream = ExtResource("2_gp4s5")
stream_1/stream = ExtResource("3_gdl1p")
stream_2/stream = ExtResource("4_v8ewj")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_1v1i4"]
random_pitch = 1.0594631
random_volume_offset_db = 1.0
streams_count = 4
stream_0/stream = ExtResource("6_fttm7")
stream_1/stream = ExtResource("7_akk5r")
stream_2/stream = ExtResource("8_x2c6u")
stream_3/stream = ExtResource("9_ei7v0")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_tk6rn"]
random_pitch = 1.3348398
random_volume_offset_db = 5.0
streams_count = 8
stream_0/stream = ExtResource("21_6h0bv")
stream_1/stream = ExtResource("22_0xprk")
stream_2/stream = ExtResource("23_0ix62")
stream_3/stream = ExtResource("24_8luhx")
stream_4/stream = ExtResource("25_xt71w")
stream_5/stream = ExtResource("26_ok33r")
stream_6/stream = ExtResource("27_hejqc")
stream_7/stream = ExtResource("30_8luhx")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_l2ec5"]
random_pitch = 1.3348398
random_volume_offset_db = 5.0
streams_count = 3
stream_0/stream = ExtResource("32_nnbp4")
stream_1/stream = ExtResource("33_4suij")
stream_2/stream = ExtResource("34_ysgge")

[sub_resource type="CylinderShape3D" id="CylinderShape3D_uhv47"]
height = 0.3729248

[sub_resource type="SphereShape3D" id="SphereShape3D_0ix62"]
radius = 25.0

[sub_resource type="SphereShape3D" id="SphereShape3D_8luhx"]
radius = 5.0

[node name="monster" type="CharacterBody3D" unique_id=832945777 node_paths=PackedStringArray("monster_steps", "purr_player", "groan_player", "screech_player", "step_timer", "search_timer", "screech_timer", "wander_timer", "nav_agent", "sight_rays")]
collision_layer = 3
script = ExtResource("1_0ix62")
monster_steps = NodePath("heartbeat")
purr_player = NodePath("purrs")
groan_player = NodePath("groans")
screech_player = NodePath("screech")
step_timer = NodePath("logic/steps_timer")
search_timer = NodePath("logic/search_timer")
screech_timer = NodePath("logic/screech_timer")
wander_timer = NodePath("logic/wander_timer")
nav_agent = NodePath("NavigationAgent3D")
sight_rays = [NodePath("sight"), NodePath("sight/sight2"), NodePath("sight/sight3"), NodePath("sight/sight4"), NodePath("sight/sight5")]

[node name="logic" type="Node" parent="." unique_id=92862137]

[node name="statemachine" type="Node" parent="logic" unique_id=901969623 node_paths=PackedStringArray("initial_state")]
script = ExtResource("1_jlss8")
initial_state = NodePath("wander")

[node name="wander" type="Node" parent="logic/statemachine" unique_id=224507659 node_paths=PackedStringArray("monster")]
script = ExtResource("2_gdl1p")
monster = NodePath("../../..")

[node name="search" type="Node" parent="logic/statemachine" unique_id=1996475802 node_paths=PackedStringArray("monster")]
script = ExtResource("3_0xprk")
monster = NodePath("../../..")

[node name="attack" type="Node" parent="logic/statemachine" unique_id=298553455 node_paths=PackedStringArray("monster")]
script = ExtResource("5_v8i5r")
sound_chance = 5
monster = NodePath("../../..")

[node name="screech_timer" type="Timer" parent="logic" unique_id=1549204285]
wait_time = 25.0
autostart = true

[node name="steps_timer" type="Timer" parent="logic" unique_id=1877996004]
wait_time = 1.5
autostart = true

[node name="search_timer" type="Timer" parent="logic" unique_id=1490241218]
wait_time = 10.0

[node name="wander_timer" type="Timer" parent="logic" unique_id=261145330]
wait_time = 30.0
autostart = true

[node name="heartbeat" type="AudioStreamPlayer3D" parent="." unique_id=53316577]
stream = SubResource("AudioStreamRandomizer_yce20")
volume_db = -20.0
max_db = -20.0
pitch_scale = 0.5
max_polyphony = 5
bus = &"heartbeat"

[node name="purrs" type="AudioStreamPlayer3D" parent="." unique_id=1326645981]
stream = SubResource("AudioStreamRandomizer_1v1i4")
pitch_scale = 0.5
max_polyphony = 5
bus = &"purrs"

[node name="groans" type="AudioStreamPlayer3D" parent="." unique_id=402786154]
stream = SubResource("AudioStreamRandomizer_tk6rn")
pitch_scale = 2.0
max_polyphony = 5
bus = &"groans"

[node name="screech" type="AudioStreamPlayer3D" parent="." unique_id=257641427]
stream = SubResource("AudioStreamRandomizer_l2ec5")
volume_db = -5.0
max_db = -5.0
pitch_scale = 2.0
max_polyphony = 5

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="." unique_id=2063737106]
avoidance_enabled = true
use_3d_avoidance = true
avoidance_layers = 3

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=2000773784]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5532837, -0.31553113)
shape = SubResource("CylinderShape3D_uhv47")

[node name="large_hearing_radius" type="Area3D" parent="." unique_id=1980168848]
collision_layer = 4
collision_mask = 4
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="large_hearing_radius" unique_id=297386381]
shape = SubResource("SphereShape3D_0ix62")

[node name="hearing_radius" type="Area3D" parent="." unique_id=1451825290]
collision_layer = 4
collision_mask = 4
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="hearing_radius" unique_id=8737666]
shape = SubResource("SphereShape3D_8luhx")

[node name="sight" type="RayCast3D" parent="." unique_id=262005093]
transform = Transform3D(-4.371139e-08, -1, 0, 1, -4.371139e-08, 0, 0, 0, 1, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight2" type="RayCast3D" parent="sight" unique_id=2127567241]
transform = Transform3D(0.98256415, 7.621459e-10, -0.18592386, 7.621459e-10, 1, 8.12699e-09, 0.18592386, -8.12699e-09, 0.98256415, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight3" type="RayCast3D" parent="sight" unique_id=464826459]
transform = Transform3D(0.9502388, 2.1751312e-09, 0.3115224, 2.1751312e-09, 1, -1.3617076e-08, -0.3115224, 1.3617076e-08, 0.9502388, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight4" type="RayCast3D" parent="sight" unique_id=1664745444]
transform = Transform3D(1, -3.9659298e-10, 5.8748664e-09, -3.9659298e-10, 0.99092704, 0.13440128, -5.874866e-09, -0.13440128, 0.99092704, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight5" type="RayCast3D" parent="sight" unique_id=1035028372]
transform = Transform3D(1, -3.1943515e-10, -5.2748272e-09, -3.194316e-10, 0.9926923, -0.120674, 5.2748272e-09, 0.120674, 0.9926923, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="monster" parent="." unique_id=660503573 instance=ExtResource("37_4suij")]
transform = Transform3D(0.3, 0, 0, 0, 0.3, 0, 0, 0, 0.3, 0, -0.4427467, 0)

[node name="l_hand" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="2" unique_id=1925841840]
transform = Transform3D(0.83796114, 0.2772844, -0.4700354, -0.09451692, 0.92202234, 0.37542036, 0.537482, -0.27016163, 0.7988274, 1.6189723, 1.4746146, 0.73504674)

[node name="l_forearm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="3" unique_id=1328960560]
transform = Transform3D(0.13827689, 0.0096360445, -0.99034625, -0.26191503, 0.9647075, -0.02718316, 0.9551333, 0.2631456, 0.13592036, 1.6071908, 0.29512423, 0.41331416)

[node name="l_arm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="4" unique_id=2038679607]
transform = Transform3D(0.52652466, 0.82834274, -0.1913616, -0.5702526, 0.17716569, -0.802137, -0.6305419, 0.5314699, 0.56564665, 0.60870117, 0.08156748, -0.22732306)

[node name="r_hand" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="5" unique_id=1326891952]
transform = Transform3D(0.5687194, -0.1264911, -0.81274676, -0.74434197, 0.34132987, -0.5739757, 0.35001758, 0.93139315, 0.09996814, -0.9003269, 0.9078449, 2.034533)

[node name="r_forearm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="6" unique_id=1626055945]
transform = Transform3D(0.75595856, -0.12715852, -0.64214975, -0.5746741, 0.34085602, -0.7440202, 0.31348926, 0.9314757, 0.18459824, -0.7448579, 0.49110055, 0.8956735)

[node name="r_arm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="7" unique_id=1575093946]
transform = Transform3D(0.37073907, -0.12896572, -0.9197388, -0.85483253, 0.33974695, -0.39221537, 0.3630608, 0.9316324, 0.01571335, -0.5894017, 0.08156726, -0.22732258)

[node name="l_foot" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="9" unique_id=1357696880]
transform = Transform3D(-0.6252344, 0.123082384, -0.7706699, -0.68955123, 0.3753614, 0.6193723, 0.36551383, 0.91866976, -0.14981717, 1.2240626, 1.5503356, 1.1565318)

[node name="l_calf" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="10" unique_id=2110775919]
transform = Transform3D(0.26418754, 0.24313135, -0.93332285, -0.93528605, 0.30083883, -0.1863747, 0.23546624, 0.92216206, 0.30687562, 0.88233197, 1.1274949, -0.13960254)

[node name="l_leg" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="11" unique_id=398573463]
transform = Transform3D(0.27230734, 0.44125652, -0.8550676, -0.9614862, 0.15924151, -0.22402157, 0.03731115, 0.88313895, 0.46762517, 0.3320531, 0.9289093, -1.2409406)

[node name="r_foot" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="12" unique_id=1545686329]
transform = Transform3D(-0.3250959, 0.600883, -0.730241, 0.18295166, 0.7975595, 0.5748282, 0.92781544, 0.053275824, -0.3692157, -0.7177365, 1.2835765, -1.6542587)

[node name="r_calf" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="13" unique_id=948173683]
transform = Transform3D(-0.89058864, 0.43077844, 0.14588279, 0.10095459, 0.4999933, -0.86012495, -0.44346365, -0.75128984, -0.48877764, -1.3232119, 0.5808171, -0.5982924)

[node name="r_leg" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="14" unique_id=609327675]
transform = Transform3D(-0.08376376, -0.81026405, -0.5800475, -0.81511307, -0.27912727, 0.5076199, -0.5732134, 0.51532495, -0.63707626, -0.31275418, 0.9289091, -1.24094)

[node name="step_targets" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="20" unique_id=2117783646 node_paths=PackedStringArray("body")]
transform = Transform3D(0.99999976, 0, 0, 0, 0.99999976, 0, 0, 0, 0.99999976, -0.045526955, -0.67269576, 0.40757078)
h_off = 0.75
body = NodePath("../../../..")

[node name="r_arm_step_target" parent="monster/Armature/Skeleton3D/step_targets" index="0" unique_id=1917531191]
transform = Transform3D(0.9999999, 0, 0, 0, 0.9999999, 0, 0, 0, 0.9999999, -0.8977476, 0, 1.0403316)

[node name="RayCast3D" parent="monster/Armature/Skeleton3D/step_targets/r_arm_step_target" index="0" unique_id=182663811]
collision_mask = 3

[node name="l_arm_step_target" parent="monster/Armature/Skeleton3D/step_targets" index="1" unique_id=1263795975]
transform = Transform3D(0.9999999, 0, 0, 0, 0.9999999, 0, 0, 0, 0.9999999, 0.81853473, 0, 0.78685)

[node name="RayCast3D" parent="monster/Armature/Skeleton3D/step_targets/l_arm_step_target" index="0" unique_id=1686285805]
collision_mask = 3

[node name="r_leg_step_target" parent="monster/Armature/Skeleton3D/step_targets" index="2" unique_id=1296562492]
transform = Transform3D(0.9999999, 0, 0, 0, 0.9999999, 0, 0, 0, 0.9999999, -1.2145994, 0, -1.4627991)

[node name="RayCast3D" parent="monster/Armature/Skeleton3D/step_targets/r_leg_step_target" index="0" unique_id=1083423952]
collision_mask = 3

[node name="l_leg_step_target" parent="monster/Armature/Skeleton3D/step_targets" index="3" unique_id=1182614964]
transform = Transform3D(0.9999999, 0, 0, 0, 0.9999999, 0, 0, 0, 0.9999999, 1.6581923, 0, -1.6687529)

[node name="RayCast3D" parent="monster/Armature/Skeleton3D/step_targets/l_leg_step_target" index="0" unique_id=1977958791]
collision_mask = 3

[node name="r_arm_target" parent="monster/Armature" parent_id_path=PackedInt32Array(660503573, 761020580) index="1" unique_id=1470774718]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.35866004, -1.5497208e-06, 1.2407659)

[node name="l_arm_target" parent="monster/Armature" parent_id_path=PackedInt32Array(660503573, 761020580) index="2" unique_id=1749603167]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.53116894, -1.4305115e-06, 0.067240745)

[node name="r_leg_target" parent="monster/Armature" parent_id_path=PackedInt32Array(660503573, 761020580) index="3" unique_id=253089859]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.078771204, -1.4305115e-06, -0.60765386)

[node name="l_leg_target" parent="monster/Armature" parent_id_path=PackedInt32Array(660503573, 761020580) index="4" unique_id=707524935]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.4081218, -1.5497208e-06, 0.42804068)

[editable path="monster"]
