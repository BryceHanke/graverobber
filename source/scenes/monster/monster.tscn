[gd_scene format=3 uid="uid://04m2i41b26xa"]

[ext_resource type="Script" uid="uid://c6yvnpxqt6x2u" path="res://scripts/monster/monster.gd" id="1_0ix62"]
[ext_resource type="Script" uid="uid://dlyn7myxb1v18" path="res://scripts/statemachine/statemachine.gd" id="1_jlss8"]
[ext_resource type="Script" uid="uid://buh1dyxd4gil8" path="res://scripts/monster/wander.gd" id="2_gdl1p"]
[ext_resource type="AudioStream" uid="uid://7m2mctf82f43" path="res://assets/sounds/monster/thud_3.mp3" id="2_gp4s5"]
[ext_resource type="Script" uid="uid://gd3kygbrdkps" path="res://scripts/monster/search.gd" id="3_0xprk"]
[ext_resource type="AudioStream" uid="uid://ck0s5sftvqvug" path="res://assets/sounds/monster/thud_1.mp3" id="3_gdl1p"]
[ext_resource type="AudioStream" uid="uid://cme26q6qadno" path="res://assets/sounds/monster/thud_2.mp3" id="4_v8ewj"]
[ext_resource type="Script" uid="uid://u07fggjsf3m3" path="res://scripts/monster/attack.gd" id="5_v8i5r"]
[ext_resource type="AudioStream" uid="uid://cyrd1qxasq04b" path="res://assets/sounds/monster/purr_1.mp3" id="6_fttm7"]
[ext_resource type="AudioStream" uid="uid://s1lcukk3380k" path="res://assets/sounds/monster/purr_2.mp3" id="7_akk5r"]
[ext_resource type="AudioStream" uid="uid://b6hv8h12hswr" path="res://assets/sounds/monster/purr_3.mp3" id="8_x2c6u"]
[ext_resource type="AudioStream" uid="uid://dh2onnnkei140" path="res://assets/sounds/monster/purr_4.mp3" id="9_ei7v0"]
[ext_resource type="AudioStream" uid="uid://ddh6fsuveww0" path="res://assets/sounds/monster/groan_1.mp3" id="21_6h0bv"]
[ext_resource type="AudioStream" uid="uid://cbvu03qhqhkhx" path="res://assets/sounds/monster/groan_2.mp3" id="22_0xprk"]
[ext_resource type="AudioStream" uid="uid://c3iss0ih36qw6" path="res://assets/sounds/monster/groan_3.mp3" id="23_0ix62"]
[ext_resource type="AudioStream" uid="uid://baxhgylquy6wk" path="res://assets/sounds/monster/groan_4.mp3" id="24_8luhx"]
[ext_resource type="AudioStream" uid="uid://bco4u4ji4pxsh" path="res://assets/sounds/monster/groan_5.mp3" id="25_xt71w"]
[ext_resource type="AudioStream" uid="uid://cgbn16af6nhnq" path="res://assets/sounds/monster/groan_6.mp3" id="26_ok33r"]
[ext_resource type="AudioStream" uid="uid://bgvgjjnfaesjj" path="res://assets/sounds/monster/groan_7.mp3" id="27_hejqc"]
[ext_resource type="AudioStream" uid="uid://cne2ieyn5vgjw" path="res://assets/sounds/monster/groan_8.mp3" id="30_8luhx"]
[ext_resource type="AudioStream" uid="uid://dxnakwin4gu5e" path="res://assets/sounds/monster/screech_1.mp3" id="32_nnbp4"]
[ext_resource type="AudioStream" uid="uid://cm8otp4qgl2kv" path="res://assets/sounds/monster/screech_2.mp3" id="33_4suij"]
[ext_resource type="AudioStream" uid="uid://gdtsec8s0kmq" path="res://assets/sounds/monster/screech_3.mp3" id="34_ysgge"]
[ext_resource type="PackedScene" uid="uid://jbyy44t3pgqv" path="res://scenes/monster/monster_visuals.tscn" id="37_4suij"]

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_yce20"]
random_pitch = 1.0594631
random_volume_offset_db = 1.0
streams_count = 3
stream_0/stream = ExtResource("2_gp4s5")
stream_1/stream = ExtResource("3_gdl1p")
stream_2/stream = ExtResource("4_v8ewj")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_1v1i4"]
random_pitch = 1.0594631
random_volume_offset_db = 1.0
streams_count = 4
stream_0/stream = ExtResource("6_fttm7")
stream_1/stream = ExtResource("7_akk5r")
stream_2/stream = ExtResource("8_x2c6u")
stream_3/stream = ExtResource("9_ei7v0")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_tk6rn"]
random_pitch = 1.3348398
random_volume_offset_db = 5.0
streams_count = 8
stream_0/stream = ExtResource("21_6h0bv")
stream_1/stream = ExtResource("22_0xprk")
stream_2/stream = ExtResource("23_0ix62")
stream_3/stream = ExtResource("24_8luhx")
stream_4/stream = ExtResource("25_xt71w")
stream_5/stream = ExtResource("26_ok33r")
stream_6/stream = ExtResource("27_hejqc")
stream_7/stream = ExtResource("30_8luhx")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_l2ec5"]
random_pitch = 1.3348398
random_volume_offset_db = 5.0
streams_count = 3
stream_0/stream = ExtResource("32_nnbp4")
stream_1/stream = ExtResource("33_4suij")
stream_2/stream = ExtResource("34_ysgge")

[sub_resource type="CylinderShape3D" id="CylinderShape3D_uhv47"]
height = 0.3729248

[sub_resource type="SphereShape3D" id="SphereShape3D_0ix62"]
radius = 25.0

[sub_resource type="SphereShape3D" id="SphereShape3D_8luhx"]
radius = 5.0

[node name="monster" type="CharacterBody3D" unique_id=832945777 node_paths=PackedStringArray("monster_steps", "purr_player", "groan_player", "screech_player", "step_timer", "search_timer", "screech_timer", "wander_timer", "nav_agent", "sight_rays")]
collision_layer = 3
script = ExtResource("1_0ix62")
monster_steps = NodePath("heartbeat")
purr_player = NodePath("purrs")
groan_player = NodePath("groans")
screech_player = NodePath("screech")
step_timer = NodePath("logic/steps_timer")
search_timer = NodePath("logic/search_timer")
screech_timer = NodePath("logic/screech_timer")
wander_timer = NodePath("logic/wander_timer")
nav_agent = NodePath("NavigationAgent3D")
sight_rays = [NodePath("sight"), NodePath("sight/sight2"), NodePath("sight/sight3"), NodePath("sight/sight4"), NodePath("sight/sight5")]

[node name="logic" type="Node" parent="." unique_id=92862137]

[node name="statemachine" type="Node" parent="logic" unique_id=901969623 node_paths=PackedStringArray("initial_state")]
script = ExtResource("1_jlss8")
initial_state = NodePath("wander")

[node name="wander" type="Node" parent="logic/statemachine" unique_id=224507659 node_paths=PackedStringArray("monster")]
script = ExtResource("2_gdl1p")
monster = NodePath("../../..")

[node name="search" type="Node" parent="logic/statemachine" unique_id=1996475802 node_paths=PackedStringArray("monster")]
script = ExtResource("3_0xprk")
monster = NodePath("../../..")

[node name="attack" type="Node" parent="logic/statemachine" unique_id=298553455 node_paths=PackedStringArray("monster")]
script = ExtResource("5_v8i5r")
sound_chance = 5
monster = NodePath("../../..")

[node name="screech_timer" type="Timer" parent="logic" unique_id=1549204285]
wait_time = 25.0
autostart = true

[node name="steps_timer" type="Timer" parent="logic" unique_id=1877996004]
wait_time = 1.5
autostart = true

[node name="search_timer" type="Timer" parent="logic" unique_id=1490241218]
wait_time = 10.0

[node name="wander_timer" type="Timer" parent="logic" unique_id=261145330]
wait_time = 30.0
autostart = true

[node name="heartbeat" type="AudioStreamPlayer3D" parent="." unique_id=53316577]
stream = SubResource("AudioStreamRandomizer_yce20")
volume_db = -20.0
max_db = -20.0
pitch_scale = 0.5
max_polyphony = 5
bus = &"heartbeat"

[node name="purrs" type="AudioStreamPlayer3D" parent="." unique_id=1326645981]
stream = SubResource("AudioStreamRandomizer_1v1i4")
pitch_scale = 0.5
max_polyphony = 5
bus = &"purrs"

[node name="groans" type="AudioStreamPlayer3D" parent="." unique_id=402786154]
stream = SubResource("AudioStreamRandomizer_tk6rn")
pitch_scale = 2.0
max_polyphony = 5
bus = &"groans"

[node name="screech" type="AudioStreamPlayer3D" parent="." unique_id=257641427]
stream = SubResource("AudioStreamRandomizer_l2ec5")
volume_db = -5.0
max_db = -5.0
pitch_scale = 2.0
max_polyphony = 5

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="." unique_id=2063737106]
avoidance_enabled = true
use_3d_avoidance = true
avoidance_layers = 3

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=2000773784]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5532837, -0.31553113)
shape = SubResource("CylinderShape3D_uhv47")

[node name="large_hearing_radius" type="Area3D" parent="." unique_id=1980168848]
collision_layer = 4
collision_mask = 4
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="large_hearing_radius" unique_id=297386381]
shape = SubResource("SphereShape3D_0ix62")

[node name="hearing_radius" type="Area3D" parent="." unique_id=1451825290]
collision_layer = 4
collision_mask = 4
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="hearing_radius" unique_id=8737666]
shape = SubResource("SphereShape3D_8luhx")

[node name="sight" type="RayCast3D" parent="." unique_id=262005093]
transform = Transform3D(-4.371139e-08, -1, 0, 1, -4.371139e-08, 0, 0, 0, 1, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight2" type="RayCast3D" parent="sight" unique_id=2127567241]
transform = Transform3D(0.98256415, 7.621459e-10, -0.18592386, 7.621459e-10, 1, 8.12699e-09, 0.18592386, -8.12699e-09, 0.98256415, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight3" type="RayCast3D" parent="sight" unique_id=464826459]
transform = Transform3D(0.9502388, 2.1751312e-09, 0.3115224, 2.1751312e-09, 1, -1.3617076e-08, -0.3115224, 1.3617076e-08, 0.9502388, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight4" type="RayCast3D" parent="sight" unique_id=1664745444]
transform = Transform3D(1, -3.9659298e-10, 5.8748664e-09, -3.9659298e-10, 0.99092704, 0.13440128, -5.874866e-09, -0.13440128, 0.99092704, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="sight5" type="RayCast3D" parent="sight" unique_id=1035028372]
transform = Transform3D(1, -3.1943515e-10, -5.2748272e-09, -3.194316e-10, 0.9926923, -0.120674, 5.2748272e-09, 0.120674, 0.9926923, 0, 0, 0)
target_position = Vector3(0, 0, 20)

[node name="monster" parent="." unique_id=660503573 instance=ExtResource("37_4suij")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)

[node name="l_hand" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="2" unique_id=1925841840]
transform = Transform3D(0.5957513, -0.031040758, -0.80256855, -0.7974421, 0.0962497, -0.5956687, 0.09573726, 0.99487257, 0.032587707, 1.0299923, -0.40592945, 1.273069)

[node name="l_forearm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="3" unique_id=1328960560]
transform = Transform3D(0.56057763, -0.533732, -0.6331526, -0.8257004, -0.30207855, -0.47641003, 0.0630137, 0.78985953, -0.6100415, 1.6825547, -0.036595903, 0.30735475)

[node name="l_arm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="4" unique_id=2038679607]
transform = Transform3D(0.31302017, 0.89086413, -0.32920924, -0.57515967, -0.098027885, -0.81214607, -0.7557836, 0.44356644, 0.48170438, 0.60870117, 0.08156748, -0.22732306)

[node name="r_hand" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="5" unique_id=1326891952]
transform = Transform3D(0.620167, 0.08221288, -0.78014904, -0.6251277, 0.6526031, -0.4281631, 0.4739276, 0.75322586, 0.45611677, -1.005824, -0.37545556, 1.3645308)

[node name="r_forearm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="6" unique_id=1626055945]
transform = Transform3D(0.5704941, 0.51135993, -0.6426868, -0.6096729, -0.26064497, -0.7485734, -0.5503038, 0.818886, 0.16306618, -1.6310334, -0.0567808, 0.36332792)

[node name="r_arm" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="7" unique_id=1575093946]
transform = Transform3D(0.34400594, -0.8641328, -0.36733282, -0.8453765, -0.11477289, -0.5216945, 0.4086535, 0.490001, -0.77000046, -0.5894017, 0.08156726, -0.22732258)

[node name="l_foot" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="9" unique_id=1357696880]
transform = Transform3D(-0.49036458, 0.26454622, -0.830396, -0.5290531, 0.66681165, 0.5248477, 0.69256425, 0.69669056, -0.18702194, 1.8009526, -0.54148734, -1.8725579)

[node name="l_calf" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="10" unique_id=2110775919]
transform = Transform3D(-0.952538, 0.2831266, 0.11185038, -0.27858427, -0.66260153, -0.6952336, -0.12272695, -0.6933962, 0.71002793, 1.4030069, 0.3898245, -0.8979627)

[node name="l_leg" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="11" unique_id=398573463]
transform = Transform3D(-0.2855409, 0.8587744, -0.4254081, -0.849506, -0.4322804, -0.3024445, -0.44362736, 0.27502662, 0.8529682, 0.3320531, 0.9289093, -1.2409406)

[node name="r_foot" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="12" unique_id=1545686329]
transform = Transform3D(-0.466267, 0.85972, -0.20850897, -0.855809, -0.37867394, 0.35241532, 0.22402199, 0.34276372, 0.91231936, -2.2191648, -0.114007235, -1.7062724)

[node name="r_calf" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="13" unique_id=948173683]
transform = Transform3D(-0.80949974, -0.58482337, 0.051878214, 0.27916995, -0.46113676, -0.84226894, 0.51650167, -0.6673337, 0.53655547, -1.3971734, 0.5341381, -0.7683097)

[node name="r_leg" parent="monster/Armature/Skeleton3D" parent_id_path=PackedInt32Array(660503573, 1824726652) index="14" unique_id=609327675]
transform = Transform3D(0.013095747, -0.86957216, -0.49363142, -0.78200525, -0.31655815, 0.53689677, -0.6231337, 0.37899166, -0.6841559, -0.31275418, 0.9289091, -1.24094)

[node name="step_targets" parent="monster/Armature" parent_id_path=PackedInt32Array(660503573, 761020580) index="1" unique_id=2117783646 node_paths=PackedStringArray("body")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.04552692, -0.6485208, 0.40757138)
body = NodePath("../../..")

[node name="r_arm_target" parent="monster/Armature" parent_id_path=PackedInt32Array(660503573, 761020580) index="2" unique_id=1470774718]
step_distance = 0.5

[editable path="monster"]
